# 동네마켓

## 로컬 기반 장보기 플랫폼

---

# Product Requirements Document (PRD)

**제품 요구사항 정의서**

- **버전:** 1.0
- **작성일:** 2026년 1월

---

## 목차

1. [제품 개요](#1-제품-개요)
2. [사용자 정의 및 페르소나](#2-사용자-정의-및-페르소나)
3. [핵심 비즈니스 플로우](#3-핵심-비즈니스-플로우)
4. [기능적 요구사항](#4-기능적-요구사항)
5. [실시간 위치 서비스 상세 명세](#5-실시간-위치-서비스-상세-명세)
6. [비기능적 요구사항](#6-비기능적-요구사항)
7. [핵심 데이터 모델](#7-핵심-데이터-모델)
8. [API 명세 요약](#8-api-명세-요약)
9. [릴리즈 계획](#9-릴리즈-계획)
10. [성공 지표 (KPIs)](#10-성공-지표-kpis)
11. [리스크 및 대응 방안](#11-리스크-및-대응-방안)

---

## 1. 제품 개요

### 1.1 제품 비전

동네마켓은 동네 주민, 마트, 배달원을 연결하여 **30분~1시간 내 초스피드 배송**과 **구독 서비스**를 제공하는 로컬 기반 장보기 플랫폼입니다. 실시간 위치 추적 기술을 통해 배달 과정의 완전한 가시성을 제공하며, 지역 상권 활성화와 소비자 편의성을 동시에 달성합니다.

### 1.2 핵심 가치 제안

| 대상 | 가치 제안 |
|------|----------|
| **소비자** | 급하게 필요한 생필품을 빠르고 저렴하게 구매, 실시간 배송 추적으로 정확한 도착 시간 예측 |
| **마트** | 안정적인 매출 채널 확보 및 신규 고객 유치, 효율적인 주문 관리 |
| **배달원** | 동네에서 부담 없는 부업 기회 제공, 최적화된 배달 경로 안내 |
| **지역사회** | 골목상권 활성화 및 지역 경제 선순환 |

### 1.3 목표 시장

| 구분 | 대상 |
|------|------|
| **1차 타겟** | 수도권 주거 밀집 지역 (반경 3km 내 마트 5개 이상 지역) |
| **2차 타겟** | 광역시 주요 주거 지역 |
| **확장 계획** | 전국 중소도시로 단계적 확장 |

---

## 2. 사용자 정의 및 페르소나

### 2.1 사용자 유형

| 사용자 유형 | 설명 | 주요 니즈 |
|------------|------|----------|
| **고객 (Customer)** | 상품을 주문하고 배송받는 일반 소비자 | 빠른 배송, 실시간 추적, 합리적 가격 |
| **마트 사장님 (Store Owner)** | 상품을 등록하고 주문을 처리하는 마트 운영자 | 효율적 주문관리, 매출 증대, 간편한 상품 관리 |
| **배달원 (Rider)** | 마트에서 고객까지 상품을 배달하는 라이더 | 최적 경로 안내, 안정적 수익, 유연한 근무 |
| **관리자 (Admin)** | 플랫폼 전체를 운영하고 관리하는 운영팀 | 실시간 모니터링, 효율적 정산, 분쟁 해결 |

### 2.2 핵심 페르소나

#### 페르소나 1: 바쁜 직장맘 김서연 (32세)

- **직업:** IT 회사 마케팅 매니저
- **상황:** 맞벌이, 초등학생 자녀 1명
- **Pain Point:** 퇴근 후 마트 갈 시간이 없음, 급하게 필요한 물품이 자주 발생
- **기대:** 퇴근길에 주문하면 집에 도착할 때 배송 완료, 배달 위치 실시간 확인

#### 페르소나 2: 동네 슈퍼 사장님 박철수 (55세)

- **상황:** 20년 운영한 동네 슈퍼, 최근 매출 감소
- **Pain Point:** 대형마트와 온라인 쇼핑몰로 인한 경쟁 심화
- **기대:** 새로운 고객 확보, 간편한 주문 관리 시스템

---

## 3. 핵심 비즈니스 플로우

### 3.1 일반 주문 플로우

| 단계 | 액션 | 상세 설명 | 위치 기능 |
|------|------|----------|----------|
| 1 | 고객 주문 | 마트 선택 → 상품 선택 → 결제 | 고객 위치 기반 마트 추천 |
| 2 | 마트 주문 접수 | 주문 확인 → 상품 준비 시작 | - |
| 3 | 배달원 매칭 | 가용 배달원에게 배달 요청 발송 | 배달원 현재 위치 기반 최적 매칭 |
| 4 | 픽업 | 배달원이 마트에서 상품 수령 | 마트까지 최적 경로 안내 |
| 5 | 배송 중 | 고객 주소로 이동 | 실시간 위치 공유, ETA 업데이트 |
| 6 | 배송 완료 | 상품 전달 및 배송 확인 | 배송 완료 위치 기록 |

### 3.2 구독 주문 플로우

```
구독 신청 → 정기 결제 등록 → 배송 일정 생성 → 자동 주문 생성 → 마트 준비 → 배달원 매칭 → 배송
```

**구독 기능:**
- 구독 주기: 매주, 격주, 매월 선택 가능
- 배송 요일/시간대 지정 가능
- 구독 일시정지, 건너뛰기, 해지 기능

---

## 4. 기능적 요구사항

### 4.1 고객 앱 기능

#### 4.1.1 회원 관리
- 회원가입/로그인 (이메일, 소셜 로그인)
- 동네 인증 (GPS 기반 현재 위치 또는 주소 검색)
- 배송 주소 관리 (최대 5개)
- 결제 수단 관리

#### 4.1.2 상품 탐색
- 마트 목록 조회 (거리순, 평점순, 배달비순 정렬)
- 실시간 마트 영업 상태 표시
- 상품 검색 (키워드, 카테고리, 바코드 스캔)
- 상품 상세 정보 (가격, 재고, 원산지, 유통기한)

#### 4.1.3 주문 및 결제
- 장바구니 관리 (수량 변경, 삭제)
- 일반 주문 (즉시 배송)
- 예약 주문 (배송 시간 지정)
- 결제 (카드, 간편결제, 포인트 사용)
- 주문 취소 (마트 접수 전까지)

#### 4.1.4 실시간 배송 추적
- 배달원 실시간 위치 지도 표시
- 예상 도착 시간(ETA) 실시간 업데이트
- 배송 상태 알림 (픽업 완료, 배송 중, 도착 임박, 배송 완료)
- 배달원 연락 기능 (앱 내 전화/채팅)

#### 4.1.5 구독 서비스
- 구독 상품 선택 및 주기 설정
- 구독 상품 변경/추가/삭제
- 배송 일정 관리 (건너뛰기, 날짜 변경)
- 구독 일시정지/해지

#### 4.1.6 기타 기능
- 주문 내역 조회 및 재주문
- 리뷰 작성 (마트, 상품, 배달)
- 고객센터 (FAQ, 1:1 문의)

### 4.2 마트 사장님 앱 기능

#### 4.2.1 마트 관리
- 마트 등록 및 승인 대기
- 마트 정보 관리 (상호, 주소, 연락처, 사진)
- 영업 시간 설정
- 배달 가능 반경 설정
- 임시 휴무 설정

#### 4.2.2 상품 관리
- 상품 등록/수정/삭제
- 카테고리별 상품 분류
- 재고 관리 (품절 처리)
- 가격 일괄 변경
- 특가/이벤트 상품 설정

#### 4.2.3 주문 관리
- 실시간 주문 알림 (푸시, 알림음)
- 주문 접수/거절
- 주문 상태 변경 (준비 중 → 준비 완료)
- 주문 내역 조회 및 검색

#### 4.2.4 매출 관리
- 일별/주별/월별 매출 통계
- 상품별 판매 현황
- 정산 내역 조회

### 4.3 배달원 앱 기능

#### 4.3.1 배달원 등록
- 배달원 등록 및 신분증 인증
- 교통수단 등록 (도보, 자전거, 오토바이, 자동차)
- 배달 가능 지역 설정

#### 4.3.2 배달 관리
- 배달 가능 시간 설정 (ON/OFF 토글)
- 배달 요청 수락/거절
- 다중 배달 관리 (최대 3건 동시)
- 배달 상태 변경 (픽업 → 배송 중 → 완료)

#### 4.3.3 실시간 위치 및 경로
- 현재 위치 실시간 전송 (배달 중)
- 마트까지 최적 경로 안내
- 고객 주소까지 최적 경로 안내
- 다중 배달 시 최적 순서 추천

#### 4.3.4 수익 관리
- 일별 수익 조회
- 배달 건수 및 거리 통계
- 정산 내역 조회
- 출금 신청

### 4.4 관리자 웹 기능

- 전체 회원 관리 (고객, 마트, 배달원)
- 마트/배달원 가입 승인/거절
- 실시간 주문 모니터링 대시보드
- 실시간 배달 현황 지도
- 정산 관리 (마트, 배달원)
- 신고/문의 처리
- 통계 및 분석 리포트

---

## 5. 실시간 위치 서비스 상세 명세

### 5.1 위치 데이터 수집

| 구분 | 수집 주기 | 정확도 | 배터리 모드 |
|------|----------|--------|------------|
| 배달원 (배달 중) | 3~5초 | High (GPS) | 활성화 필요 안내 |
| 배달원 (대기 중) | 30초~1분 | Medium | 배터리 최적화 |
| 고객 (주문 시) | 1회 (주문 시점) | High | - |

### 5.2 위치 기반 핵심 기능

#### 5.2.1 고객용 기능
- **배달원 실시간 위치 지도 표시:** 배달원 현재 위치를 지도에 핀으로 표시, 3~5초 간격 위치 업데이트
- **ETA 실시간 업데이트:** 교통 상황, 배달원 이동 속도 반영하여 도착 예상 시간 자동 갱신
- **도착 알림:** 배달원이 500m, 100m 이내 도착 시 푸시 알림
- **배송 경로 표시:** 마트 → 현재 배달원 위치 → 배송지 경로 시각화

#### 5.2.2 배달원용 기능
- **턴바이턴 네비게이션:** 마트/고객 주소까지 실시간 경로 안내
- **다중 배달 최적화:** 여러 건 배달 시 최적 순서 자동 추천
- **목적지 도착 알림:** 마트/고객 위치 50m 이내 도착 시 자동 알림
- **배달 구역 표시:** 본인 담당 배달 가능 구역 시각화

#### 5.2.3 마트용 기능
- **배달원 도착 예상 시간:** 배달원이 픽업 오는 시간 표시
- **배달 가능 범위 설정:** 마트 기준 배달 가능 반경 지도에서 설정

#### 5.2.4 관리자용 기능
- **실시간 배달 현황 지도:** 모든 진행 중인 배달 건 위치 실시간 표시
- **히트맵 분석:** 주문 밀집 지역, 배달 지연 지역 분석
- **배달 시간 분석:** 예상 vs 실제 배달 시간 비교 통계

### 5.3 기술 스택 제안

| 구성 요소 | 기술 옵션 | 설명 |
|----------|----------|------|
| 위치 수집 (모바일) | Google Play Services Location / iOS Core Location | 네이티브 GPS API |
| 실시간 통신 | WebSocket / Server-Sent Events | 실시간 양방향 통신 |
| 지도 서비스 | Kakao Maps API / Naver Maps API | 국내 주소 체계 최적화 |
| 경로 탐색 | Kakao Mobility / T map API | 실시간 교통 정보 반영 |
| 위치 저장 | Redis (실시간) + PostgreSQL (이력) | 고속 읽기/쓰기 |
| Geofencing | Redis GEO / PostGIS | 특정 영역 진입/이탈 감지 |

### 5.4 데이터 플로우

```
1. 배달원 앱에서 위치 정보 수집 (GPS)
2. WebSocket으로 서버에 위치 전송
3. 서버에서 Redis에 현재 위치 저장 (TTL 적용)
4. 고객 앱이 WebSocket으로 해당 주문의 배달원 위치 구독
5. 위치 변경 시 구독 중인 고객에게 실시간 푸시
6. 고객 앱에서 지도 마커 업데이트
```

### 5.5 개인정보 보호

- 배달원 위치는 배달 진행 중인 해당 주문의 고객에게만 공개
- 배달 완료 후 실시간 위치 추적 즉시 중단
- 위치 이력 데이터 90일 후 자동 삭제 (정산/분쟁 해결용 보관)
- 고객 동의 기반 위치 정보 수집 (앱 권한 요청)
- GDPR/개인정보보호법 준수

---

## 6. 비기능적 요구사항

### 6.1 성능 요구사항

| 항목 | 목표 | 측정 방법 |
|------|------|----------|
| API 응답 시간 | 95% < 200ms | APM 모니터링 |
| 실시간 위치 업데이트 지연 | < 1초 | WebSocket latency |
| 동시 접속자 처리 | 10,000+ 명 | 부하 테스트 |
| 앱 초기 로딩 시간 | < 3초 | Performance 측정 |
| 지도 렌더링 시간 | < 2초 | 지도 SDK 콜백 |

### 6.2 가용성 요구사항

- **서비스 가용성:** 99.9% (월간 다운타임 43분 이내)
- **장애 복구 시간(RTO):** 30분 이내
- **데이터 손실 허용 범위(RPO):** 5분 이내
- **다중 가용영역(AZ) 배포**

### 6.3 확장성 요구사항

- 수평 확장 가능한 마이크로서비스 아키텍처
- 피크 타임(점심/저녁) 3배 트래픽 대응
- 지역 확장 시 독립적 스케일링 가능

### 6.4 보안 요구사항

- HTTPS/TLS 1.3 통신 암호화
- JWT 기반 인증
- 개인정보 암호화 저장 (AES-256)
- SQL Injection, XSS 방어
- PG사 PCI-DSS 인증 연동

---

## 7. 핵심 데이터 모델

### 7.1 주요 엔티티

| 엔티티 | 주요 속성 | 관계 |
|--------|----------|------|
| **User** | id, email, name, phone, role, address, location | 1:N Order, 1:N Address |
| **Store** | id, name, address, location, deliveryRadius, businessHours | 1:N Product, 1:N Order |
| **Product** | id, name, price, stock, category, storeId | N:1 Store, N:M Order |
| **Order** | id, status, totalPrice, deliveryFee, deliveryAddress | N:1 User, N:1 Store, 1:1 Delivery |
| **Delivery** | id, riderId, orderId, status, pickupTime, deliveryTime | N:1 Rider, 1:1 Order |
| **RiderLocation** | riderId, latitude, longitude, timestamp, accuracy | N:1 Rider (실시간 위치) |
| **Subscription** | id, userId, cycle, nextDeliveryDate, products | N:1 User, N:M Product |

### 7.2 상태 다이어그램

#### 주문 상태

```
PENDING(결제대기) → PAID(결제완료) → ACCEPTED(마트접수) → PREPARING(준비중) → READY(준비완료) → PICKED_UP(픽업완료) → DELIVERING(배송중) → DELIVERED(배송완료)

* CANCELLED(취소됨) - 결제완료 이전까지 취소 가능
* REJECTED(거절됨) - 마트에서 주문 거절
```

#### 배달 상태

```
REQUESTED(요청됨) → ACCEPTED(수락됨) → PICKING_UP(픽업이동중) → PICKED_UP(픽업완료) → DELIVERING(배송중) → DELIVERED(배송완료)
```

---

## 8. API 명세 요약

### 8.1 위치 서비스 API

| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/riders/location` | 배달원 위치 업데이트 |
| GET | `/api/v1/orders/{orderId}/tracking` | 주문 배송 추적 정보 조회 |
| WS | `/ws/tracking/{orderId}` | 실시간 배송 위치 구독 |
| GET | `/api/v1/stores/nearby` | 주변 마트 조회 (위도, 경도, 반경) |
| GET | `/api/v1/delivery/eta` | 예상 도착 시간 조회 |
| GET | `/api/v1/riders/{riderId}/route` | 배달 경로 안내 |

### 8.2 주요 API Endpoints

#### 인증
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/auth/signup` | 회원가입 |
| POST | `/api/v1/auth/login` | 로그인 |
| POST | `/api/v1/auth/refresh` | 토큰 갱신 |

#### 주문
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/orders` | 주문 생성 |
| GET | `/api/v1/orders/{orderId}` | 주문 상세 조회 |
| PATCH | `/api/v1/orders/{orderId}/status` | 주문 상태 변경 |
| DELETE | `/api/v1/orders/{orderId}` | 주문 취소 |

#### 구독
| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/subscriptions` | 구독 신청 |
| PATCH | `/api/v1/subscriptions/{subId}` | 구독 수정 |
| POST | `/api/v1/subscriptions/{subId}/skip` | 배송 건너뛰기 |
| DELETE | `/api/v1/subscriptions/{subId}` | 구독 해지 |

---

## 9. 릴리즈 계획

### Phase 1: MVP (8주)

**고객:**
- 회원가입, 마트/상품 조회, 주문, 실시간 배송 추적

**마트:**
- 마트 등록, 상품 등록, 주문 접수/상태 변경

**배달원:**
- 등록, 배달 수락, 상태 변경, 위치 전송

**관리자:**
- 마트/배달원 승인, 주문 모니터링

### Phase 2: 구독 서비스 (4주)

- 구독 상품 선택 및 주기 설정
- 자동 결제 연동
- 구독 관리 (일시정지, 변경, 해지)

### Phase 3: 고도화 (4주)

- 리뷰 시스템
- 쿠폰/포인트 시스템
- 통계 대시보드 고도화
- 다중 배달 최적화 알고리즘

### Phase 4: 확장 (지속)

- 지역 확장
- AI 기반 수요 예측
- 마트 재고 연동

---

## 10. 성공 지표 (KPIs)

| 지표 | 목표 (출시 6개월) | 측정 방법 |
|------|------------------|----------|
| 월간 활성 사용자(MAU) | 50,000명 | Analytics |
| 월간 주문 건수 | 100,000건 | 주문 데이터 |
| 평균 배송 시간 | 45분 이내 | 배송 완료 시간 |
| 고객 만족도(NPS) | 40 이상 | 설문조사 |
| 구독 전환율 | 15% | 구독자 / 전체 주문자 |
| 재주문율 | 60% | 재주문 고객 비율 |
| 배송 추적 사용률 | 80% | 추적 페이지 조회 |

---

## 11. 리스크 및 대응 방안

| 리스크 | 영향도 | 대응 방안 |
|--------|--------|----------|
| 배달원 수급 부족 | 높음 | 인센티브 프로그램, 탄력적 배달비 정책 |
| 위치 정확도 오차 | 중간 | GPS 보정, 건물 입구 좌표 DB 구축 |
| 피크 타임 서버 부하 | 높음 | Auto Scaling, 캐싱 최적화, CDN 활용 |
| 개인정보 유출 | 높음 | 암호화, 접근 제어, 정기 보안 감사 |
| 마트 이탈 | 중간 | 낮은 수수료 정책, 마트 지원 프로그램 |

---

*— 문서 끝 —*
